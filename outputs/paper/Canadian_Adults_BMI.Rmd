---
title: "Obesity in Canada (title might be changed after analysis)"
subtitle: "A study on obesity in Canada with data from Statistics Canada"
author: Justin Teng   
thanks: "'Code and data are available in this GitHub repository: https://github.com/justinteng1999/Canadian_Adult_BMI"
date: "April 26, 2022" 
abstract: This report presents an analysis of the data from Statistics Canada on the population of obesed people in Canada. This analysis focuses on the variables, suhc as States, Gender and Age in relation with Body Mass Index (BMI). The analysis is consisted of logistic regression performed with the statistical programming language R. The result we obtained from the paper will increase the awareness of obesity for certain groups of people,who have higher risk of being obese. Morever, it can contribute to the development of medical solution for people who are suffering from obesity. 
  \par\textbf{Keywords:} obesity, BMI, age and BMI, gender and BMI, obese population in Canada, Statistics Canada, 
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("dplyr")
#install.packages("ggplot2")

library(tidyverse)
library(ggplot2)
library(dplyr)
library(patchwork)
library(kableExtra)
```


```{r reading in data, include=FALSE}

#Reading in the cleaned data 
BMI_data <- read.csv("BMI_cleaned.csv")

# Making the year 2004 and 2015 character instead of numeric 
BMI_data$REF_DATE <- as.character(BMI_data$REF_DATE)

# Splitting up the data set into 2004 and 2015 ones
BMI_data_2004 <- BMI_data %>%
  filter(REF_DATE == "2004")

BMI_data_2015 <- BMI_data %>%
  filter(REF_DATE == "2015")
```

# Introduction

  Obesity is a major issue in the Canadian society nowadays. For instance, according to the 2015 Canadian Health Measures Survey, approximately 1 in 3 Canadian adults is obese and may require medical support to manage their disease.[@obesityCAN] Moreover, obesity prevalence rates in Canadian adults are projected to increase over the next two decades. Obesity is a progressive chronic disease that is characterized by abnormal or excessive fat accumulation that may impair one's health condition.[@obesityCAN] An obese adult is at a higher risk of certain chronic conditions, including hypertension, type two diabetes, cardiovascular diseases, cancers, and of premature death in the worst case.[@NIH] It is estimated that 1 in 10 premature deaths among Canadian adults age 20 to 64 is directly attributable to obesity. Other than all of its negative impact on health, it also affects one's overall social and economic well-being due to the body-discriminating social stigma associated with it.
The data for this report was obtained from Statistics Canada released on 2017-08-01, and this dataset contains the survey done in both 2004 and 2015 with the same variables recorded.  In this report, the data is analyzed on the relation between each variable and the Body Mass Index(BMI) of Canadian adults(18+). The main variables we will be focusing on are age group, sexes and each province of Canada.


# Data

 This report was produced with R Statistical Programming Language[@citeR] in the R Markdown file format. The dataset I utilized for this report is publicly available through Statistics Canada[@StatCan]. This dataset contains a wide range of variables, such as the measured adult body mass index(BMI) by age group, sexes and provinces of Canada.  In addition the survey was conducted by the Canadian Community Health Survey on the year of 2004 and 2015. After obtaining the dataset, the tidyverse[@citeTidyverse] package is used to clean and manipulate the data leaving only the variables needed for this analysis. The variables I selected for the analysis are "REF_DATE", "GEO", "Sex", "Age.group", "BMI", "Number_of_Persons". This report will be focusing on the relationship between BMI and the proportion of obesity with other variables.  In this report, tables and graphs are generated with kableExtra[@citekableExtra], patchwork[@citepatchwork], and ggplot2[@ggplot2]. At the end, bookdown[@citemarkdown] and knitr[@citeKnitr] are used to format the report.    

 In the original data set, every numbers, such as number of persons, coefficient of variation, population proportion, high and low confidence interval are all mixed together under the variable VALUE. Therefore, I decided to use only the number of persons as the values for the calculation in our analysis. Since the data of both 2004 and 2015 are also mixed in this raw dataset, I calculated the proportion for each variable corresponding the the year of the survey, and the calculated proportions is then put into a separated new column. Moreover, the range of each age group is modified since there are several age groups that overlaps with each other.  For instance, there were "18~20 years" and "18~24 years" which have two years of overlapping. 

# Results

```{r YearBMI,echo=FALSE, message=FALSE, warning=FALSE, fig.width= 7, fig.height= 4, fig.cap="Canadian's BMI in 2004 and 2015"}

# Create a subset where we can compare the BMI between 2004 and 2015
BMI_data_years <- 
  BMI_data %>% 
  subset(GEO == "Canada" & Age.group == "Total, 18 years and over" & Sex == "Both sexes" & BMI != "Total Population" & BMI != "Obese Class I" & BMI !="Obese Class II" & BMI != "Obese Class III")

# Add percentages to the data set 
BMI_data_years <-
  BMI_data_years %>% 
  group_by(REF_DATE) %>% 
  mutate(Percent = Number_of_Persons/sum(Number_of_Persons))
  

# Create a bar graph to compare the BMI between 2004 and 2015
ggplot(BMI_data_years, 
       aes(x = reorder(BMI, Percent), 
           y = Percent, 
           fill = REF_DATE)) + 
geom_bar(stat="identity", position="dodge")+
labs(x= "BMI", y = "Proportion", fill = "Year")
```

```{r SexBMI,echo=FALSE, message=FALSE, warning=FALSE,fig.width= 7, fig.height= 4, fig.cap="2015 Genders vs. BMI"}

# Create a subset where we can compare the BMI between Males and Females
BMI_data_sex <-
  BMI_data %>%
  subset(REF_DATE == "2015" & GEO == "Canada" & Age.group == "Total, 18 years and over" & Sex != "Both sexes" & BMI != "Total Population" & BMI != "Obese")

# Add percentages to the data set 
BMI_data_sex <-
  BMI_data_sex %>% 
  group_by(Sex) %>%
  mutate(Percent = Number_of_Persons/sum(Number_of_Persons))

# Create a bar graph to compare the BMI of Males and Females in 2015
ggplot(BMI_data_sex, aes(x = BMI, y = Percent, fill = Sex)) + 
  geom_bar(stat="identity", position="dodge")+
  theme(axis.text.x = element_text(angle = 50, vjust = 1, hjust= 1)) +
  labs(x= "BMI", y = "Proportion", fill = "Gender")
```

```{r AgeBMI, echo=FALSE, message=FALSE, warning=FALSE, fig.width= 7, fig.height= 4, fig.cap ="Proportion of Obesity at Different Ages"}

# Create a subset where we can compare the BMI on different ages 
BMI_data_age <-
  BMI_data %>%
  subset(GEO == "Canada" & Age.group != "Total, 18 years and over" & Age.group != "18 to 19 years" & Age.group != "18 to 34 years" & Age.group != "20 to 24 years" & Age.group != "45 to 64 years" & Age.group != "65 years and over" & Sex == "Both sexes" & BMI == "Obese")

# Add percentages to the data set 
BMI_data_age <-
  BMI_data_age %>% 
  group_by(REF_DATE) %>%
  mutate(Percent = Number_of_Persons/sum(Number_of_Persons))

# Create a line graph to show BMI vs ages in both 2004 and 2015 
ggplot(BMI_data_age, aes(x = Age.group, y = Percent, group = REF_DATE, color = REF_DATE))+ 
  geom_point() +
  geom_line() + 
  theme(axis.text.x = element_text(angle = 50, vjust = 1, hjust= 1)) +
  labs(x= "Age Group", y = "Proportion", color = "Year")
```

```{r StateBMI, echo=FALSE, message=FALSE, warning=FALSE, fig.width= 7, fig.height= 4, fig.cap ="Proportion of Obesity in Different States"}

# Create a subset where we can compare the Proportion of Obesity between States
BMI_data_state <-
  BMI_data %>%
  subset(GEO != "Canada" & Age.group == "Total, 18 years and over" & Sex == "Both sexes" & BMI == "Obese")

# Add percentages to the data set 
BMI_data_state <-
  BMI_data_state %>% 
  group_by(REF_DATE) %>%
  mutate(Percent = Number_of_Persons/sum(Number_of_Persons))

# Create a line graph to show BMI vs ages in both 2004 and 2015 
ggplot(BMI_data_state, aes(x = GEO, y = Percent, group = REF_DATE, linetype = REF_DATE))+ 
  geom_point() +
  geom_line() + 
  theme(axis.text.x = element_text(angle = 50, vjust = 1, hjust= 1)) +
  labs(x= "States in Canada", y = "Proportion", linetype = "Year")
```
\newpage

# Discussion

## Year
In Figure\@ref(fig:YearBMI), we can see that there are a significantly higher proportion 26.68% of people who are obese compared to 23.09% of obese people in 2004. On the other end of being underweight, the year of 2015 also has a higher proportion of people than the year 2004. In the 10 year span from 2004 to 2015, proportion of people being normal weight decreased by 2.80%. 

## Gender
In Figure\@ref(fig:SexBMI), females tend to have a healthier BMI of being normal weight than males.  

## Age
In Figure\@ref(fig:AgeBMI), we can tell that between the age of 45 to 54 years old, there are highest proportions of obese people in both 2004 and 2015.

## State
In Figure\@ref(fig:StateBMI), the distribution of obese population in different states are almost identical in both 2004 and 2015, with Ontario having the highest proportion of obese people and Prince Edward Island being the lowest.  This is probably because of the large difference of population between each state. 


\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


